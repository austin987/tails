**FIXME** this process is quite complicated and should be automated using VMs

# 0. prepare the systems

## prepare a Tails USB stick

Install the Tails version to test on a 1st USB stick.

## prepare a minimal lenny live system 

We will use this system to do a coldboot attack. It is useful that it is a
minimal system so that it doesn't fill the RAM to boot.

To be able to grep /dev/mem, it must have a kernel with CONFIG_STRICT_DEVMEM
disabled. It is enabled in debian since 2.6.28-1, so we use lenny:

    lb config  --architecture i386 --linux-flavours 686 --apt-recommends false --distribution lenny --binary-images usb-hdd --binary-indices false  --memtest none --packages-lists="minimal" --syslinux-menu vesamenu --initramfs=live-initramfs

Then install this image on a 2nd USB stick

# 1. fill the RAM with a known pattern

* boot on Tails
* add `fillram.py` which contains:

    string=""
    while True:
        string = string + "wipe_didnt_work\n"

* launch it:

    $ python fillram.py

# 2. test that you can get the pattern

* plug the USB stick containing the minimal lenny live system
* reboot from Tails using SysRq + B
* under syslinux, append `init=/bin/bash` to the kernel commandline in order to
  run the test in the initramfs
* actually do the test:

    grep -c wipe_didnt_work /dev/mem

  - you should get some integer larger than zero if the pattern was found in
    RAM, which is the expected result ;
  - you should get `grep: /dev/mem: Cannot allocate memory` otherwise. In that
    case, it is **not** useful to process to the next step, there is something
    wrong in the way you tested.

# 3. test that sdmem really hides the pattern

* redo step 1
* reboot from Tails the recommanded way : system > reboot
* plug the USB stick containing the minimal lenny live system
* when Tails displays that you can remove the USB stick, remove Tails and 
  plug the USB stick containing the minimal lenny live system
* under syslinux, append `init=/bin/bash` to the kernel commandline in order to
  run the test in the initramfs
* actually do the test:

    grep -c wipe_didnt_work /dev/mem

  - you should get zero if the pattern was not found in RAM, which is the
    optimal (and expected) result;
  - you should get an integer larger than zero if the pattern was found in
    RAM, which means that smem failed. However, there seems to be certain
    legit conditions which can make this happen any way. For instance, the new
    kernel loaded with kexec may allocate some buffer in the memory space
    that was filled with the pattern, and thus that space will not be wiped
    by smem. Hence a "reasonably small" number of occurances is still
    acceptible as it currently is unavoidable. For now, let us arbitrarily
    choose that up to 500 000 occurences (or around 8 MB since each pattern is
    16 bytes) are acceptable.
