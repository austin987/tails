One serious security issue is that we don't know what software will
attempt to contact the network and whether their proxy settings are
setup to use the Tor SOCKS proxy or polipo HTTP(s) proxy correctly.
This is solved by blocking all outbound Internet traffic except Tor
and I2P, and explicitly configure all applications to use either of
these.

- [[!tails_gitweb config/chroot_local-includes/etc/firewall.conf]] for IPv4
- [[!tails_gitweb config/chroot_local-includes/etc/firewall6.conf]] for IPv6
- [[!tails_gitweb config/chroot_local-includes/etc/NetworkManager/dispatcher.d/00-firewall.sh]]

The default case is to block all outbound network traffic; let us now
document all exceptions and some clarifications to this rule.

#### Tor user

Tor itself obviously has to connect to the Internet without going
through the Tor network. This is achieved by special-casing
connections originating from the `debian-tor` Unix user.

#### I2P

[I2P](http://www.i2pproject.net/) (*Invisible Internet Project*) is
yet another anonymizing network
(load-balanced unspoofable packet switching network) that provides
access to eepsites (.i2p tld); eepsites are a bit like Tor hidden
services. Some users would like to be able to access eepsites from
Tails.

Like the `debian-tor` user, the `i2p` user is allowed to connect
*directly* to the Internet. See [[the design document dedicated to
Tails use of I2P|I2P]] for details.

#### Local Area Network (LAN)

Tails short description talks of sending through Tor *outgoing
connections to the Internet*. Indeed: traffic to the local LAN
(RFC1918 addresses) is wide open as well as the loopback traffic
obviously.

It is planned to [[forbid LAN DNS
queries|todo/forbid_lan_dns_queries]] at some point to protect against
some attacks; this is not implemented yet.

#### IPv6

Tor does not support IPv6 yet so IPv6 communication is allowed only on
the loopback interface.

#### UDP, ICMP and other non-TCP protocols

Tor only supports TCP. Non-TCP traffic to the Internet, such as UDP
datagrams and ICMP packets, is dropped unless it's going through I2P,
which supports UDP.
